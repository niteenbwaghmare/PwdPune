using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Data.SqlClient;
using System.Linq;
using System.Web;

namespace PWdEEBudget
{
    public class AllHeadReportClass
    {
        public string query = string.Empty;
        public string unionQuery = string.Empty;
        string Complet = string.Empty;
        SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnString"].ToString());

        public DataTable ArthsankalpiyYear()
        {
            DataTable dt = new DataTable();
            try
            {
                if (con.State != ConnectionState.Open)
                    con.Open();

                SqlCommand objcmd = new SqlCommand("[GetAllProvArthYear_SP]", con);
                objcmd.CommandType = CommandType.StoredProcedure;
                SqlDataAdapter objAdp = new SqlDataAdapter(objcmd);
                objAdp.Fill(dt);

                return dt;
            }
            catch (Exception)
            {

                throw;
            }
            finally
            {
                con.Close();
            }
        }

        public string Building(string whereCondi, string groupBy, string from)
        {
            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[LekhaShirshName] ORDER BY a.[LekhaShirshName],a.[Arthsankalpiyyear],a.[upvibhag]) as 'अ क्र', a.[WorkId] as 'वर्क आयडी',a.[Arthsankalpiyyear] as 'अर्थसंकल्पीय वर्ष',a.[KamacheName] as 'कामाचे नाव',a.[LekhaShirshName] as 'लेखाशीर्ष नाव',a.[SubType] as 'विभाग',a.[Upvibhag] as 'उपविभाग',a.[Taluka] as 'तालुका',a.[ArthsankalpiyBab] as 'अर्थसंकल्पीय बाब',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'शाखा अभियंता नाव',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'उपअभियंता नाव',a.[AmdaracheName] as 'आमदारांचे नाव',a.[KhasdaracheName] as 'खासदारांचे नाव',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'ठेकेदार नाव',convert(nvarchar(max),a.[PrashaskiyKramank])+' '+convert(nvarchar(max),a.[PrashaskiyAmt])+' '+convert(nvarchar(max),a.[PrashaskiyDate])as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',convert(nvarchar(max),a.[TrantrikKrmank])+' '+convert(nvarchar(max),a.[TrantrikAmt])+' '+convert(nvarchar(max),a.[TrantrikDate])as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',a.[Kamachevav] as 'कामाचा वाव',convert(nvarchar(max),a.[NividaKrmank])+' '+convert(nvarchar(max),a.[NividaDate])as 'कार्यारंभ आदेश',cast(mahapwdd_EEPwdEastPuneDB.GetNumeric(case when mahapwdd_EEPwdEastPuneDB.GetNumeric([NividaAmt])!='' then mahapwdd_EEPwdEastPuneDB.GetNumeric([NividaAmt])else '0.0' end) as decimal(10,2)) as 'निविदा रक्कम % कमी / जास्त',a.[kamachiMudat] as 'बांधकाम कालावधी',a.[KamPurnDate] as 'काम पूर्ण तारीख',CAST(CASE WHEN b.[MudatVadhiDate] = ' ' or b.[MudatVadhiDate] = '0' THEN N'होय' ELSE N'नाही' END as nvarchar(max)) as 'मुदतवाढ बाबत',b.[ManjurAmt] as 'मंजूर अंदाजित किंमत',b.[MarchEndingExpn] as 'मार्च अखेर खर्च 2017',b.[UrvaritAmt] as 'उर्वरित किंमत',b.[Chalukharch] as 'चालु खर्च',b.[Magilkharch] as 'मागील खर्च',b.[VarshbharatilKharch] as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेरचा खर्च',b.[AikunKharch] as 'एकुण कामावरील खर्च',b.[Takunone] as 'प्रथम तिमाही तरतूद',b.[Takuntwo] as 'द्वितीय तिमाही तरतूद',b.[Takunthree] as 'तृतीय तिमाही तरतूद',b.[Takunfour] as 'चतुर्थ तिमाही तरतूद',b.[Tartud]as 'अर्थसंकल्पीय तरतूद',b.[AkunAnudan] as 'वितरित तरतूद',b.[Magni] as 'मागणी',b.[Vidyutprama] as 'विद्युतीकरणावरील प्रमा',b.[Vidyutvitarit] as 'विद्युतीकरणावरील वितरित',b.[Itarkhrch] as 'इतर खर्च',b.[Dviguni] as 'दवगुनी ज्ञापने',a.[Pahanikramank] as 'पाहणी क्रमांक',a.[PahaniMudye] as 'पाहणीमुद्ये',b.[DeyakachiSadyasthiti] as 'देयकाची सद्यस्थिती',convert(nvarchar(max),a.[Sadyasthiti])+' '+convert(nvarchar(max),a.[Shera]) as 'शेरा',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar'  " + from + whereCondi;
            unionQuery = "  union select isNULL ('','')as'अ क्र', 'Total' as 'वर्क आयडी',isNULL ('Total','') as 'अर्थसंकल्पीय वर्ष',isNULL ('','') as 'कामाचे नाव',isNULL (a.[LekhaShirshName],'') as 'लेखाशीर्ष नाव',isNULL ('','') as 'विभाग',isNULL ('','') as 'उपविभाग',isNULL ('','0') as 'तालुका',isNULL ('','') as 'अर्थसंकल्पीय बाब',isNULL ('','') as 'शाखा अभियंता नाव',isNULL ('','') as 'उपअभियंता नाव',isNULL ('','') as 'आमदारांचे नाव',isNULL ('','') as 'खासदारांचे नाव',isNULL ('','') as 'ठेकेदार नाव',isNULL ('','') as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक ',isNULL ('','') as 'कामाचा वाव',isNULL ('','') as 'कार्यारंभ आदेश',sum(cast(mahapwdd_EEPwdEastPuneDB.GetNumeric(case when mahapwdd_EEPwdEastPuneDB.GetNumeric([NividaAmt])!='' then mahapwdd_EEPwdEastPuneDB.GetNumeric([NividaAmt])else '0.0' end) as decimal(10,2)))  as 'निविदा रक्कम % कमी / जास्त',isNULL ('','') as 'बांधकाम कालावधी',isNULL ('','') as 'काम पूर्ण तारीख',isNULL ('','') as 'मुदतवाढ बाबत',sum(b.[ManjurAmt]) as 'मंजूर अंदाजित किंमत',sum(b.[MarchEndingExpn])as 'मार्च अखेर खर्च 2017',sum(b.[UrvaritAmt]) as 'उर्वरित किंमत',sum(b.[Chalukharch])as 'चालु खर्च',sum(b.[Magilkharch])as 'मागील खर्च',sum(b.[VarshbharatilKharch]) as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेरचा खर्च',sum(b.[AikunKharch]) as 'एकुण कामावरील खर्च',sum(b.[Takunone]) as 'प्रथम तिमाही तरतूद',sum(b.[Takuntwo]) as 'द्वितीय तिमाही तरतूद',sum(b.[Takunthree]) as 'तृतीय तिमाही तरतूद',sum(b.[Takunfour]) as 'चतुर्थ तिमाही तरतूद',sum(b.[Tartud])as 'अर्थसंकल्पीय तरतूद',sum(b.[AkunAnudan]) as 'वितरित तरतूद',sum(b.[Magni]) as 'मागणी',sum(b.[Vidyutprama]) as 'प्रमा',sum(b.[Vidyutvitarit]) as 'वितरित',sum(b.[Itarkhrch]) as 'इतर खर्च',isNULL ('','') as 'दवगुनी ज्ञापने',isNULL ('','') as 'पाहणी क्रमांक',isNULL ('','') as 'पाहणीमुद्ये',isNULL ('','') as 'देयकाची सद्यस्थिती',isNULL ('','') as 'शेरा',sum (b.[Apr]) as [Apr],sum (b.[May]) as [May],sum (b.[Jun]) as [Jun],sum (b.[Jul]) as [Jul],sum (b.[Aug]) as [Aug],sum (b.[Sep]) as [Sep],sum (b.[Oct]) as [Oct],sum (b.[Nov]) as [Nov],sum (b.[Dec]) as [Dec],sum (b.[Jan]) as [Jan],sum (b.[Feb]) as [Feb],sum (b.[Mar]) as [Mar]   " + from + whereCondi + groupBy;
            Complet = query + unionQuery;

            return Complet;
        }

        public string Crf(string whereCondi, string groupBy)
        {
            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[Arthsankalpiyyear] ORDER BY a.[Arthsankalpiyyear],a.[upvibhag]desc) as 'SrNo', a.[WorkId] as 'WorkId',a.[ArthsankalpiyBab] as 'Budget of Item',a.[Arthsankalpiyyear] as 'Budget of Year',a.[KamacheName] as 'Name of Work',a.[LekhaShirsh] as 'Head',a.[LekhaShirshName] as 'Headwise',a.[Type] as 'Type',a.[SubType] as 'SubType',a.[Upvibhag] as 'Sub Division',a.[Taluka] as 'Taluka',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'Sectional Engineer',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'Deputy Engineer',a.[AmdaracheName] as 'MLA',a.[KhasdaracheName] as 'MP',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'Contractor',a.[PrashaskiyKramank] as 'Administrative No',a.[PrashaskiyDate] as 'A A Date',a.[PrashaskiyAmt] as 'A A Amount',a.[TrantrikKrmank] as 'Technical Sanction No',a.[TrantrikDate] as 'T S Date',a.[TrantrikAmt] as 'T S Amount',a.[Kamachavav] as 'Scope of Work',a.[karyarambhadesh] as 'Work Order',a.[NividaKrmank] as 'Tender No',cast(a.[NividaAmt] as decimal(10,2)) as 'Tender Amount',a.[NividaDate] as 'Tender Date',a.[kamachiMudat] as 'Work Order Date',a.[KamPurnDate] as 'Work Completion Date',b.[MudatVadhiDate] as 'Extension Month',a.[SanctionDate] as 'SanctionDate',a.[SanctionAmount] as 'SanctionAmount',b.[ManjurAmt] as 'Estimated Cost Approved',b.[MarchEndingExpn] as 'MarchEndingExpn',b.[UrvaritAmt] as 'Remaining Cost',b.[VarshbharatilKharch] as 'Annual Expense',b.[Magilmonth] as 'Previous Month',b.[Magilkharch] as 'Previous Cost',b.[Chalumonth] as 'Current Month',b.[Chalukharch] as 'Current Cost',b.[AikunKharch] as 'Total Expense',b.[DTakunone] as 'First Provision Month',b.[Takunone] as 'First Provision',b.[DTakuntwo] as 'Second Provision Month',b.[Takuntwo] as 'Second Provision',b.[DTakunthree] as 'Third Provision Month',b.[Takunthree] as 'Third Provision',b.[DTakunfour] as 'Fourth Provision Month',b.[Takunfour] as 'Fourth Provision',b.[Tartud] as 'Grand Provision',b.[AkunAnudan] as 'Total Grand',b.[Magni] as 'Demand',b.[OtherExpen] as 'Other Expense',b.[ExpenCost] as 'Electricity Cost',b.[ExpenExpen] as 'Electricity Expense',a.[JobNo] as 'JobNo',a.[RoadNo] as 'Road Category',a.[RoadLength] as 'RoadLength',a.[APhysicalScope] as 'W.B.M Wide Phy Scope',a.[ACommulative] as 'W.B.M Wide Commulative',a.[ATarget] as 'W.B.M Wide Target',a.[AAchievement] as 'W.B.M Wide Achievement',a.[BPhysicalScope] as 'B.T Phy Scope',a.[BCommulative] as 'B.T Commulative',a.[BTarget] as 'B.T Target',a.[BAchievement] as 'B.T Achievement',a.[CPhysicalScope] as 'C.D Phy Scope',a.[CCommulative] as 'C.D Commulative',a.[CTarget] as 'C.D Target',a.[CAchievement] as 'C.D Achievement',a.[DPhysicalScope] as 'Minor Bridges Phy Scope(Nos)',a.[DCommulative] as 'Minor Bridges Commulative(Nos)',a.[DTarget] as 'Minor Bridges Target(Nos)',a.[DAchievement] as 'Minor Bridges Achievement(Nos)',a.[EPhysicalScope] as 'Major Bridges Phy Scope(Nos)',a.[ECommulative] as 'Major Bridges Commulative(Nos)',a.[ETarget] as 'Major Bridges Target(Nos)',a.[EAchievement] as 'Major Bridges Achievement(Nos)',b.[DeyakachiSadyasthiti] as 'Bill Status',a.[Pahanikramank] as 'Observation No',a.[PahaniMudye] as 'Observation Memo',a.[Sadyasthiti] as 'Status',a.[Shera] as 'Remark',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterCRF as a join CRFProvision as b on a.WorkId=b.WorkId  " + whereCondi;
            unionQuery = " union select isNULL ('','')as'SrNo', 'Total' as 'WorkId',isNULL ('','') as 'Budget of Item',isNULL (a.[Arthsankalpiyyear],'') as 'Arthsankalpiyyear',isNULL ('','') as 'Name of Work',isNULL ('','') as 'Head',isNULL ('','') as 'Headwise',isNULL ('','') as 'Type',isNULL ('','') as 'SubType',isNULL ('','') as 'Sub Division',isNULL ('','') as 'Taluka',isNULL ('','') as 'Sectional Engineer',isNULL ('','') as 'Deputy Engineer',isNULL ('','') as 'MLA',isNULL ('','') as 'MP',isNULL ('','') as 'Contractor',isNULL ('','') as 'Administrative No',isNULL ('','') as 'A A Date',sum(cast(a.[PrashaskiyAmt] as decimal(10,0))) as 'A A Amount',isNULL ('','') as 'Technical Sanction No',isNULL ('','') as 'T S Date',sum(cast(a.[TrantrikAmt]as decimal(10,0))) as 'T S Amount',isNULL ('','') as 'Scope of Work',isNULL ('','') as 'Work Order',isNULL ('','') as 'Tender No',sum(cast(a.[NividaAmt] as decimal(10,2))) as 'Tender Amount',isNULL ('','') as 'Tender Date',isNULL ('','') as 'Work Order Date',isNULL ('','') as 'Work Completion Date',isNULL ('','') as 'Extension Month',isNULL ('','') as 'SanctionDate',sum(a.[SanctionAmount]) as 'SanctionAmount',sum(b.[ManjurAmt]) as 'Estimated Cost Approved',sum(b.[MarchEndingExpn]) as 'MarchEndingExpn',sum(b.[UrvaritAmt]) as 'Remaining Cost',sum(b.[VarshbharatilKharch]) as 'Annual Expense',isNULL ('','') as 'Previous Month',sum(b.[Magilkharch]) as 'Previous Cost',isNULL ('','') as 'Current Month',sum(b.[Chalukharch]) as 'Current Cost',sum(b.[AikunKharch]) as 'Total Expense', isNULL ('','') as 'First Provision Month',sum(b.[Takunone]) as 'First Provision',isNULL ('','') as 'Second Provision Month',sum(b.[Takuntwo]) as 'Second Provision',isNULL ('','') as 'Third Provision Month',sum(b.[Takunthree]) as 'Third Provision',isNULL ('','') as 'Fourth Provision Month',sum(b.[Takunfour]) as 'Fourth Provision',sum(b.[Tartud]) as 'Grand Provision',sum(b.[AkunAnudan]) as 'Total Grand',sum(b.[Magni]) as 'Demand',sum(b.[OtherExpen]) as 'Other Expense',sum(b.[ExpenCost]) as 'Electricity Cost',sum(b.[ExpenExpen]) as 'Electricity Expense',isNULL ('','') as 'JobNo',isNULL ('','') as 'Road Category',isNULL ('','') as 'RoadLength',sum(a.[APhysicalScope]) as 'W.B.M Wide Phy Scope',sum(a.[ACommulative]) as 'W.B.M Wide Commulative',sum(a.[ATarget]) as 'W.B.M Wide Target',sum(a.[AAchievement]) as 'W.B.M Wide Achievement',sum(a.[BPhysicalScope]) as 'B.T Phy Scope',sum(a.[BCommulative]) as 'B.T Commulative',sum(a.[BTarget]) as 'B.T Target',sum(a.[BAchievement]) as 'B.T Achievement',sum(a.[CPhysicalScope]) as 'C.D Phy Scope',sum(a.[CCommulative]) as 'C.D Commulative',sum(a.[CTarget]) as 'C.D Target',sum(a.[CAchievement]) as 'C.D Achievement',sum(a.[DPhysicalScope]) as 'Minor Bridges Phy Scope(Nos)',sum(a.[DCommulative]) as 'Minor Bridges Commulative(Nos)',sum(a.[DTarget]) as 'Minor Bridges Target(Nos)',sum(a.[DAchievement]) as 'Minor Bridges Achievement(Nos)',sum(a.[EPhysicalScope]) as 'Major Bridges Phy Scope(Nos)',sum(a.[ECommulative]) as 'Major Bridges Commulative(Nos)',sum(a.[ETarget]) as 'Major Bridges Target(Nos)',sum(a.[EAchievement]) as 'Major Bridges Achievement(Nos)',isNULL ('','') as 'Bill Status',isNULL ('','') as 'Observation No',isNULL ('','') as 'Observation Memo',isNULL ('','') as 'Status',isNULL ('','') as 'Remark',sum(b.[Apr]) as 'Apr',sum(b.[May]) as 'May',sum(b.[Jun]) as 'Jun',sum(b.[Jul]) as 'Jul',sum(b.[Aug]) as 'Aug',sum(b.[Sep]) as 'Sep',sum(b.[Oct]) as 'Oct',sum(b.[Nov]) as 'Nov',sum(b.[Dec]) as 'Dec',sum(b.[Jan]) as 'Jan',sum(b.[Feb]) as 'Feb',sum(b.[Mar]) as 'Mar' from BudgetMasterCRF as a join CRFProvision as b on a.WorkId=b.WorkId " + whereCondi + groupBy;

            Complet = query + unionQuery;

            return Complet;
        }

        public string Nabard(string whereCondi, string groupBy)
        {

            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[RDF_SrNo] ORDER BY a.[Upvibhag]) as 'SrNo', a.[WorkId] as 'Work Id',a.[RDF_NO] as 'RIDF NO', a.[RDF_SrNo] as 'SrNo',a.[Arthsankalpiyyear] as 'Budget of Year',a.Dist as 'District',a.[Taluka] as 'Taluka',a.[ArthsankalpiyBab] as 'Budget of Item',a.[KamacheName]as 'Name of Work',a.[Kamachavav] as 'Scope of Work',a.[LekhaShirshName] as 'Headwise',a.[SubType] as 'Division',a.[Upvibhag] as 'Sub Division',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'Sectional Engineer',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'Deputy Engineer',a.[AmdaracheName] as 'MLA',a.[KhasdaracheName] as 'MP',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'Contractor',a.[PrashaskiyKramank] as 'Administrative No',a.[PrashaskiyDate] as 'A A Date',a.[PIC_NO] as 'PIC No',cast(a.[PrashaskiyAmt] as decimal(10,2)) as 'AA cost Rs in lakhs',cast(a.[TrantrikAmt]as decimal(10,2))as 'Technical Sanction Cost Rs in Lakh',a.[TrantrikKrmank]+' '+a.[TrantrikDate] as 'Technical Sanction No and Date',a.[NividaKrmank] as 'Tender No',cast(a.[NividaAmt] as decimal(10,2)) as 'Tender Amount',a.[karyarambhadesh] as 'Work Order',a.[NividaDate] as 'Tender Date',a.[kamachiMudat] as 'Work Order Date',a.[KamPurnDate] as 'Work Completion Date',b.[MudatVadhiDate] as 'Extension Month',b.[ManjurAmt] as 'Estimated Cost Approved',b.[MarchEndingExpn] as 'Expenditure up to MAR 2017',b.[UrvaritAmt] as 'Remaining Cost',b.[Chalukharch] as 'Current Cost',b.[Magilkharch] as 'Previous Cost',b.[VarshbharatilKharch] as 'Expenditure up to 8/2016 during year 16-17 Rs in Lakhs',b.[AikunKharch] as 'Total Expense',b.[Takunone] as 'Budget Provision in 2017-18 Rs in Lakhs',b.[Takuntwo] as 'Second Provision',b.[Takunthree] as 'Third Provision',b.[Takunfour] as 'Fourth Provision',b.[Tartud] as 'Total Provision',b.[AkunAnudan] as 'Total Grand',b.[Magni] as 'Demand for 2017-18 Rs in Lakhs',a.[PahaniMudye] as 'Observation Memo',a.[Pahanikramank] as 'Probable date of completion',b.[DeyakachiSadyasthiti] as 'Bill Status',a.[Sadyasthiti] as 'Physical Progress of work',a.[Road_No] as 'Road Category',a.[LengthRoad] as 'Road Length',a.[RoadType] as 'Road Type',a.[WBMI_km] as 'WBMI Km',a.[WBMII_km] as 'WBMII Km',a.[WBMIII_km] as 'WBMIII Km',a.[BBM_km] as 'BBM Km',a.[Carpet_km] as 'Carpet Km',a.[Surface_km] as 'Surface Km',cast(a.[CD_Works_No] as decimal(10,2))  as 'CD_Works_No',a.[PCR] as 'PCR submitted or not',a.[Shera] as 'Remark',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterNABARD as a join NABARDProvision as b on a.WorkId=b.WorkId " + whereCondi;
            unionQuery = " union select isNULL (a.[RDF_SrNo],'')as'SrNo',isNULL ('Total','') as 'Work Id',isNULL ('','')as 'RIDF NO', cast(a.[RDF_SrNo] as int) as 'srno',isNULL ('Total','')as 'Budget of Year',isNULL ('','') as 'District',isNULL ('','') as 'Taluka',isNULL ('','') as 'Budget of Item',isNULL ('','')as 'Name of Work',isNULL ('','') as 'Scope of Work',isNULL ('','')as 'Headwise',isNULL ('','') as 'Division',isNULL ('','') as 'Sub Division',isNULL ('','') as 'Sectional Engineer',isNULL ('','') as 'Deputy Engineer',isNULL ('','') as 'MLA',isNULL ('','') as 'MP',isNULL ('','') as 'Contractor',isNULL ('','') as 'Administrative No',isNULL ('','') as 'A A Date','Total' as 'PIC No',sum(cast(a.[PrashaskiyAmt] as decimal(10,2))) as 'AA cost Rs in lakhs',sum(cast(a.[TrantrikAmt]as decimal(10,2)))as 'Technical Sanction Cost Rs in Lakh',isNULL ('','') as 'Technical Sanction No and Date',isNULL ('','') as 'Tender No',sum(cast(a.[NividaAmt] as decimal(10,2))) as 'Tender Amount',isNULL ('','') as 'Work Order',isNULL ('','') as 'Tender Date',isNULL ('','') as 'Work Order Date',isNULL ('','') as 'Work Completion Date',isNULL ('','') as 'Extension Month',sum(b.[ManjurAmt]) as 'Estimated Cost Approved',sum(b.[MarchEndingExpn]) as 'Expenditure up to MAR 2017',sum(b.[UrvaritAmt]) as 'Remaining Cost',sum(b.[Chalukharch]) as 'Current Cost',sum(b.[Magilkharch]) as 'Previous Cost',sum(b.[VarshbharatilKharch]) as 'Expenditure up to 8/2016 during year 16-17 Rs in Lakhs',sum(b.[AikunKharch]) as 'Total Expense', sum(b.[Takunone]) as 'Budget Provision in 2017-18 Rs in Lakhs',sum(b.[Takuntwo]) as 'Second Provision',sum(b.[Takunthree]) as 'Third Provision',sum(b.[Takunfour]) as 'Fourth Provision',sum(b.[Tartud]) as 'Total Provision',sum(b.[AkunAnudan]) as 'Total Grand',sum(b.[Magni]) as 'Demand for 2017-18 Rs in Lakhs',isNULL ('','') as 'Observation Memo',isNULL ('','') as 'Probable date of completion',isNULL ('','') as 'Bill Status',isNULL ('','') as 'Physical Progress of work',isNULL ('','') as 'Road Category',isNULL ('','') as 'Road Length',isNULL ('','') as 'Road Type',sum(a.[WBMI_km]) as 'WBMI Km',sum(a.[WBMII_km]) as 'WBMII Km',sum(a.[WBMIII_km]) as 'WBMIII Km',sum(a.[BBM_km]) as 'BBM Km',sum(a.[Carpet_km]) as 'Carpet Km',sum(a.[Surface_km]) as 'Surface Km',sum(cast(a.[CD_Works_No] as decimal(10,2)))  as 'CD_Works_No',isNULL ('','') as 'PCR submitted or not',isNULL ('','')as 'Remark',sum(b.[Apr]) as 'Apr',sum(b.[May]) as 'May',sum(b.[Jun]) as 'Jun',sum(b.[Jul]) as 'Jul',sum(b.[Aug]) as 'Aug',sum(b.[Sep]) as 'Sep',sum(b.[Oct]) as 'Oct',sum(b.[Nov]) as 'Nov',sum(b.[Dec]) as 'Dec',sum(b.[Jan]) as 'Jan',sum(b.[Feb]) as 'Feb',sum(b.[Mar]) as 'Mar' from BudgetMasterNABARD as a join NABARDProvision as b on a.WorkId=b.WorkId " + whereCondi + groupBy;

            Complet = query + unionQuery;
            return Complet;
        }

        public string Road(string whereCondi, string groupBy)
        {
            string query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[LekhaShirshName]ORDER BY a.LekhaShirshName desc,a.[Arthsankalpiyyear],a.[Taluka],a.[upvibhag]) as 'अ.क्र', a.[WorkId] as 'वर्क आयडी',a.PageNo as 'पान क्र',a.ArthsankalpiyBab as 'बाब क्र',a.JulyBab as 'जुलै/ बाब क्र./पान क्र.',a.[Arthsankalpiyyear] as 'अर्थसंकल्पीय वर्ष',a.[KamacheName] as 'कामाचे नाव',a.[LekhaShirshName] as 'लेखाशीर्ष नाव',a.[SubType] as 'विभाग',a.[Upvibhag] as 'उपविभाग',a.[Taluka] as 'तालुका',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'शाखा अभियंता नाव',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'उपअभियंता नाव',a.[AmdaracheName] as 'आमदारांचे नाव',a.[KhasdaracheName] as 'खासदारांचे नाव',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'ठेकेदार नाव',convert(nvarchar(max),a.[PrashaskiyKramank])+' '+convert(nvarchar(max),a.[PrashaskiyAmt])+' '+convert(nvarchar(max),a.[PrashaskiyDate])as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',convert(nvarchar(max),a.[TrantrikKrmank])+' '+convert(nvarchar(max),a.[TrantrikAmt])+' '+convert(nvarchar(max),a.[TrantrikDate])as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',a.[Kamachevav] as 'कामाचा वाव',convert(nvarchar(max),a.[NividaKrmank])+' '+convert(nvarchar(max),a.[NividaDate])as 'कार्यारंभ आदेश',cast(a.[NividaAmt] as decimal(10,2)) as 'निविदा रक्कम % कमी / जास्त',a.[kamachiMudat] as 'बांधकाम कालावधी',a.[KamPurnDate] as 'काम पूर्ण तारीख',CAST(CASE WHEN b.[MudatVadhiDate] = ' ' or b.[MudatVadhiDate] = '0' THEN N'होय' ELSE N'नाही' END as nvarchar(max)) as 'मुदतवाढ बाबत',b.[ManjurAmt] as 'मंजूर अंदाजित किंमत',b.[MarchEndingExpn] as 'सुरवाती पासून मार्च 2017 अखेरचा खर्च',b.[UrvaritAmt] as 'उर्वरित किंमत',b.[VarshbharatilKharch] as 'सन 2017-18 मधील माहे एप्रिल/मे अखेरचा खर्च',b.[Magilkharch] as 'मागील खर्च',b.[AikunKharch] as 'एकुण कामावरील खर्च',b.[Takunone] as'2017-18 मधील अर्थसंकल्पीय तरतूद मार्च 2017',b.[Takuntwo] as '2017-18 मधील अर्थसंकल्पीय तरतूद जुलै 2017',b.[Takunthree] as'तृतीय तिमाही तरतूद',b.[Takunfour] as 'चतुर्थ तिमाही तरतूद',b.[Tartud] as 'एकूण अर्थसंकल्पीय तरतूद',b.[AkunAnudan] as '2017-18 मधील वितरीत तरतूद',b.[Magni] as '2017-18 साठी मागणी',b.[Vidyutprama] as 'विद्युतीकरणावरील प्रमा',b.[Vidyutvitarit] as 'विद्युतीकरणावरील वितरित',b.[Itarkhrch] as 'इतर खर्च',b.[Dviguni] as 'दवगुनी ज्ञापने',a.[PahaniMudye] as 'पाहणीमुद्ये',a.[Pahanikramank] as 'पाहणी क्रमांक',CAST(CASE WHEN a.[Sadyasthiti] = 'Completed'  THEN 1 ELSE 0 END as decimal(10,0)) as 'C',CAST(CASE WHEN a.[Sadyasthiti] = 'Processing'  THEN 1 ELSE 0 END as decimal(10,0)) as 'P',CAST(CASE WHEN a.[Sadyasthiti] = 'Not Started'  THEN 1 ELSE 0 END as decimal(10,0)) as 'NS',convert(nvarchar(max),a.[Sadyasthiti])+' '+convert(nvarchar(max),a.[Shera]) as 'शेरा',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterRoad as a join RoadProvision as b on a.WorkId=b.WorkId " + whereCondi;
            string unionQuery = " union select isNULL ('','')as'अ.क्र', 'Total' as 'वर्क आयडी',isNULL ('','') as 'पान क्र',isNULL ('','') as 'बाब क्र',isNULL ('','') as 'जुलै/ बाब क्र./पान क्र.',isNULL ('Total','') as 'अर्थसंकल्पीय वर्ष',isNULL ('','') as 'कामाचे नाव', a.[LekhaShirshName] as 'लेखाशीर्ष नाव',isNULL ('','') as 'विभाग',isNULL ('','') as 'उपविभाग',isNULL ('','') as 'तालुका',isNULL ('','') as 'शाखा अभियंता नाव',isNULL ('','') as 'उपअभियंता नाव',isNULL ('','') as 'आमदारांचे नाव',isNULL ('','') as 'खासदारांचे नाव',isNULL ('','') as 'ठेकेदार नाव',isNULL ('','') as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'कामाचा वाव',isNULL ('','') as 'कार्यारंभ आदेश',sum(cast(a.[NividaAmt] as decimal(10,2))) as 'निविदा रक्कम % कमी / जास्त',isNULL ('','') as 'बांधकाम कालावधी',isNULL ('','') as 'काम पूर्ण तारीख',isNULL ('','') as 'मुदतवाढ बाबत',sum(b.[ManjurAmt]) as 'मंजूर अंदाजित किंमत',sum(b.[MarchEndingExpn]) as 'सुरवाती पासून मार्च 2017 अखेरचा खर्च',sum(b.[UrvaritAmt]) as 'उर्वरित किंमत',sum(b.[VarshbharatilKharch]) as 'सन 2017-18 मधील माहे एप्रिल/मे अखेरचा खर्च',sum(b.[Magilkharch]) as 'मागील खर्च',sum(b.[AikunKharch]) as 'एकुण कामावरील खर्च',sum(b.[Takunone]) as'2017-18 मधील अर्थसंकल्पीय तरतूद मार्च 2017',sum(b.[Takuntwo]) as '2017-18 मधील अर्थसंकल्पीय तरतूद जुलै 2017',sum(b.[Takunthree]) as'तृतीय तिमाही तरतूद',sum(b.[Takunfour]) as 'चतुर्थ तिमाही तरतूद',sum(b.[Tartud]) as 'एकूण अर्थसंकल्पीय तरतूद',sum(b.[AkunAnudan]) as '2017-18 मधील वितरीत तरतूद',sum(b.[Magni]) as '2017-18 साठी मागणी',sum(b.[Vidyutprama]) as 'प्रमा',sum(b.[Vidyutvitarit]) as 'वितरित',sum(b.[Itarkhrch]) as 'इतर खर्च',isNULL ('','') as 'दवगुनी ज्ञापने',isNULL ('','') as 'पाहणीमुद्ये',isNULL ('','') as 'पाहणी क्रमांक',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Completed'  THEN 1 ELSE 0 END as decimal(10,0))) as 'C',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Processing'  THEN 1 ELSE 0 END as decimal(10,0))) as 'P',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Not Started'  THEN 1 ELSE 0 END as decimal(10,0))) as 'NS',isNULL ('','') as 'शेरा',sum (b.[Apr]) as [Apr],sum (b.[May]) as [May],sum (b.[Jun]) as [Jun],sum (b.[Jul]) as [Jul],sum (b.[Aug]) as [Aug],sum (b.[Sep]) as [Sep],sum (b.[Oct]) as [Oct],sum (b.[Nov]) as [Nov],sum (b.[Dec]) as [Dec],sum (b.[Jan]) as [Jan],sum (b.[Feb]) as [Feb],sum (b.[Mar]) as [Mar] from BudgetMasterRoad as a join RoadProvision as b on a.WorkId=b.WorkId " + whereCondi + groupBy;

            Complet = query + unionQuery;

            return Complet;
        }

        public string Dpdc(string whereCondi, string groupBy)
        {
            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[Arthsankalpiyyear], a.[Upvibhag] ORDER BY a.[Arthsankalpiyyear],a.[upvibhag],a.[Taluka]desc) as 'अ क्र', a.[WorkId] as 'वर्क आयडी',a.[LekhaShirshName] as 'योजनेचे नाव',b.[ComputerCRC] as 'सीआरसी (संगणक) संकेतांक',b.[ObjectCode] as 'उद्यीष्ट संकेतांक(ऑब्जेक्ट कोड)',a.[Arthsankalpiyyear] as 'अर्थसंकल्पीय वर्ष',a.[KamacheName] as 'योजनेचे / कामाचे नांव',a.[SubType] as 'विभाग',a.[Upvibhag] as 'उपविभाग',a.[Taluka] as 'तालुका',a.[ArthsankalpiyBab] as 'अर्थसंकल्पीय बाब',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'शाखा अभियंता नाव',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'उपअभियंता नाव',a.[AmdaracheName] as 'आमदारांचे नाव',a.[KhasdaracheName] as 'खासदारांचे नाव',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'ठेकेदार नाव',convert(nvarchar(max),a.[PrashaskiyKramank])+' '+convert(nvarchar(max),a.[PrashaskiyAmt])+' '+convert(nvarchar(max),a.[PrashaskiyDate])as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',convert(nvarchar(max),a.[TrantrikKrmank])+' '+convert(nvarchar(max),a.[TrantrikAmt])+' '+convert(nvarchar(max),a.[TrantrikDate])as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',a.[Kamachevav] as 'कामाचा वाव',a.[karyarambhadesh] as 'कार्यारंभ आदेश',convert(nvarchar(max),a.[NividaKrmank])+' '+convert(nvarchar(max),a.[NividaDate])as 'निविदा क्र/दिनांक',cast(a.[NividaAmt] as decimal(10,2)) as 'निविदा रक्कम % कमी / जास्त',a.[kamachiMudat] as 'बांधकाम कालावधी',a.[KamPurnDate] as 'काम पूर्ण होण्याचा अपेक्षित दिनांक',convert(nvarchar(max),a.[NividaAmt])+' '+convert(nvarchar(max),b.[MudatVadhiDate]) as 'सुधारित अंदाजित किंमतीचा दिनांक',CAST(CASE WHEN a.[LekhaShirsh] = N'५०५४४२४६'  THEN '1' END as nvarchar(max)) as 'एकूण कामे',b.[DeyakachiSadyasthiti] as 'देयकाची सद्यस्थिती',b.[ManjurAmt] as 'एकूण अंदाजित किंमत (अलिकडील सुधारित)',b.[MarchEndingExpn] as 'मार्च अखेर खर्च 2017',b.[UrvaritAmt] as 'सन 2017-2018 मधील अपेक्षित खर्च',b.[Chalukharch] as 'चालू खर्च',b.[Magilkharch] as 'मागील खर्च',b.[VarshbharatilKharch] as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेरचा खर्च',b.[AikunKharch] as 'एकुण कामावरील खर्च',b.[Takunone] as 'उर्वरित किंमत (6-(8+9))',b.[Takuntwo] as 'द्वितीय तिमाही तरतूद',b.[Takunthree] as 'तृतीय तिमाही तरतूद',b.[Takunfour] as 'चतुर्थ तिमाही तरतूद',b.[Tartud] as '2017-2018 करीता प्रस्तावित तरतूद',b.[Tartud]as 'काम निहाय तरतूद सन 2017-2018',b.[AkunAnudan] as 'वितरित तरतूद',b.[Magni] as 'मागणी 2017-2018',b.[Vidyutprama] as 'विद्युतीकरणावरील प्रमा',b.[Vidyutvitarit] as 'विद्युतीकरणावरील वितरित',b.[Jun] as 'वितरीत तरतूद सन 2017-2018',b.[Itarkhrch] as 'इतर खर्च',b.[Dviguni] as 'दवगुनी ज्ञापने',a.[PahaniMudye] as 'पाहणीमुद्ये',CAST(CASE WHEN a.[Sadyasthiti] = 'Completed'  THEN 1 ELSE 0 END as decimal(10,0)) as 'पुर्ण',CAST(CASE WHEN a.[Sadyasthiti] = 'Processing'  THEN 1 ELSE 0 END as decimal(10,0)) as 'प्रगतीत',CAST(CASE WHEN a.[Sadyasthiti] = 'Not Started'  THEN 1 ELSE 0 END as decimal(10,0)) as 'निविदा स्तर',a.[Shera] as 'शेरा',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterDPDC as a join DPDCProvision as b on a.WorkId=b.WorkId  " + whereCondi;
            unionQuery = " union select isNULL ('','')as'अ क्र',  'Total' as 'वर्क आयडी', isNULL ('','') as 'योजनेचे नाव',isNULL ('','') as 'सीआरसी (संगणक) संकेतांक',isNULL ('','') as 'उद्यीष्ट संकेतांक(ऑब्जेक्ट कोड)',isNULL (a.[Arthsankalpiyyear],'') as 'अर्थसंकल्पीय वर्ष',isNULL ('','') as 'योजनेचे / कामाचे नांव',isNULL ('','') as 'विभाग', isNULL (a.[Upvibhag],'') as 'उपविभाग', isNULL ('','') as 'तालुका',isNULL ('','') as 'अर्थसंकल्पीय बाब',isNULL ('','') as 'शाखा अभियंता नाव',isNULL ('','') as 'उपअभियंता नाव',isNULL ('','') as 'आमदारांचे नाव',isNULL ('','') as 'खासदारांचे नाव',isNULL ('','') as 'ठेकेदार नाव', isNULL ('','')as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक', isNULL ('','') as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'कामाचा वाव',isNULL ('','') as 'कार्यारंभ आदेश',isNULL ('','') as 'निविदा क्र/दिनांक',sum(cast(a.[NividaAmt] as decimal(10,2))) as 'निविदा रक्कम % कमी / जास्त',isNULL ('','') as 'बांधकाम कालावधी', isNULL ('','') as 'काम पूर्ण होण्याचा अपेक्षित दिनांक', isNULL ('','') as 'सुधारित अंदाजित किंमतीचा दिनांक',isNULL ('','') as 'एकूण कामे',isNULL ('','') as 'देयकाची सद्यस्थिती',sum(b.[ManjurAmt]) as 'एकूण अंदाजित किंमत (अलिकडील सुधारित)',sum(b.[MarchEndingExpn]) as 'मार्च अखेर खर्च 2017', sum(b.[UrvaritAmt]) as 'सन 2017-2018 मधील अपेक्षित खर्च',sum(b.[Chalukharch])as 'चालू खर्च', sum(b.[Magilkharch]) as 'मागील खर्च',sum(b.[VarshbharatilKharch]) as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेरचा खर्च',sum(b.[AikunKharch]) as 'एकुण कामावरील खर्च',sum(b.[Takunone]) as 'उर्वरित किंमत (6-(8+9))',sum(b.[Takuntwo]) as 'द्वितीय तिमाही तरतूद',sum(b.[Takunthree]) as 'तृतीय तिमाही तरतूद',sum(b.[Takunfour]) as 'चतुर्थ तिमाही तरतूद', sum(b.[Tartud]) as '2017-2018 करीता प्रस्तावित तरतूद', sum(b.[Tartud]) as 'काम निहाय तरतूद सन 2017-2018',sum(b.[AkunAnudan]) as 'वितरित तरतूद', sum(b.[Magni]) as 'मागणी 2017-2018',sum(b.[Vidyutprama]) as 'प्रमा',sum(b.[Vidyutvitarit]) as 'वितरित',sum(b.[Jun]) as 'वितरीत तरतूद सन 2017-2018',sum(b.[Itarkhrch]) as 'इतर खर्च',isNULL ('','') as 'दवगुनी ज्ञापने',isNULL ('','') as 'पाहणीमुद्ये', sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Completed'  THEN 1 ELSE 0 END as decimal(10,0))) as 'पुर्ण', sum( CAST(CASE WHEN a.[Sadyasthiti] = 'Processing'  THEN 1 ELSE 0 END as decimal(10,0))) as 'प्रगतीत', sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Not Started'  THEN 1 ELSE 0 END as decimal(10,0))) as 'निविदा स्तर', isNULL ('','') as 'शेरा',sum (b.[Apr]) as [Apr],sum (b.[May]) as [May],sum (b.[Jun]) as [Jun],sum (b.[Jul]) as [Jul],sum (b.[Aug]) as [Aug],sum (b.[Sep]) as [Sep],sum (b.[Oct]) as [Oct],sum (b.[Nov]) as [Nov],sum (b.[Dec]) as [Dec],sum (b.[Jan]) as [Jan],sum (b.[Feb]) as [Feb],sum (b.[Mar]) as [Mar] from BudgetMasterDPDC as a join DPDCProvision as b on a.WorkId=b.WorkId  " + whereCondi + groupBy;
            Complet = query + unionQuery;
            return Complet;
        }

        public string Mla(string whereCondi, string groupBy)
        {
            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[AmdaracheName] order by  a.[AmdaracheName],a.[Arthsankalpiyyear],a.[Taluka],a.[PageNo]) as 'अ क्र', a.[WorkId] as 'वर्क आयडी',a.[Arthsankalpiyyear] as 'अर्थसंकल्पीय बाब क्र./प्रथम समाविष्ट झालेल्या वर्ष',a.[PageNo] as 'प्रकार',a.[Taluka] as 'तालुका',a.[KamacheName] as 'कामाचे नाव',a.[Upvibhag] as 'उपविभाग',a.[AmdaracheName] as 'आमदारांचे नाव',a.[KhasdaracheName] as 'खासदारांचे नाव',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'शाखा अभियंता नाव',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'उपअभियंता नाव',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'ठेकेदार नाव',convert(nvarchar(max),a.[PrashaskiyKramank])+' '+convert(nvarchar(max),a.[PrashaskiyAmt])+' '+convert(nvarchar(max),a.[PrashaskiyDate])as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',convert(nvarchar(max),a.[TrantrikKrmank])+' '+convert(nvarchar(max),a.[TrantrikAmt])+' '+convert(nvarchar(max),a.[TrantrikDate])as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',a.[Kamachevav] as 'कामाचा वाव',convert(nvarchar(max),a.[NividaKrmank])+' '+convert(nvarchar(max),a.[NividaDate])as 'कार्यांरभ आदेश/दिनांक',cast(a.[NividaAmt] as decimal(10,2)) as 'निविदा रक्कम % कमी / जास्त',a.[kamachiMudat] as 'बांधकाम कालावधी',a.[KamPurnDate] as 'काम पूर्ण तारीख',b.[MudatVadhiDate] as 'मुदतवाढ दिनांक',CAST(CASE WHEN a.[LekhaShirsh] = N'५०५४४२४६'  THEN 1 ELSE 0 END as decimal(10,0)) as 'एकूण कामे',b.[ManjurAmt] as 'सन 2017-2018 मधील अपेक्षित खर्च',b.[MarchEndingExpn] as 'मार्च अखेर खर्च 2017',b.[UrvaritAmt] as 'उर्वरित किंमत (6-(8+9))',b.[Chalukharch] as 'एकुण उपलब्ध अनुदान',b.[Magilkharch] as 'सन 2016 - 17  06/2016 अखेर खर्च',b.[VarshbharatilKharch] as 'सन 2017-18 मधील माहे एप्रिल/मे अखेरचा खर्च',b.[AikunKharch] as 'एकुण कामावरील खर्च',b.[Takunone] as 'प्रथम तिमाही तरतूद',b.[Takuntwo] as 'द्वितीय तिमाही तरतूद',b.[Takunthree] as 'तृतीय तिमाही तरतूद',b.[Takunfour] as 'चतुर्थ तिमाही तरतूद',b.[Tartud] as 'काम निहाय तरतूद सन 2017-2018',b.[AkunAnudan] as 'वितरीत तरतूद सन 2017-2018',b.[Magni] as 'मागणी 2017-18',b.[Vidyutprama] as 'विद्युतप्रमा',b.[Vidyutvitarit] as 'विद्युत वितरीत',b.[Itarkhrch] as 'इतर खर्च',b.[Dviguni] as 'द्वीगुणी',a.[PahaniMudye] as 'पाहणीमुद्ये',a.[Pahanikramank] as 'पाहणी क्रमांक',CAST(CASE WHEN a.[Sadyasthiti] = 'Completed'  THEN 1 ELSE 0 END as decimal(10,0)) as 'पुर्ण',CAST(CASE WHEN a.[Sadyasthiti] = 'Processing'  THEN 1 ELSE 0 END as decimal(10,0)) as 'प्रगतीत',CAST(CASE WHEN a.[Sadyasthiti] = 'Not Started'  THEN 1 ELSE 0 END as decimal(10,0)) as 'निविदा स्तर',a.[Shera] as 'शेरा',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterMLA as a join MLAProvision as b on a.WorkId=b.WorkId " + whereCondi;
            unionQuery = " union select isNULL ('','')as'अ क्र', 'Total' as 'वर्क आयडी','Total' as 'अर्थसंकल्पीय बाब क्र./प्रथम समाविष्ट झालेल्या वर्ष',isNULL ('','') as 'प्रकार',isNULL ('','') as 'तालुका',isNULL ('','') as 'कामाचे नाव',isNULL ('','') as 'उपविभाग',isNULL (a.[AmdaracheName],'') as 'आमदारांचे नाव',isNULL ('','') as 'खासदारांचे नाव',isNULL ('','') as 'शाखा अभियंता नाव',isNULL ('','') as 'उपअभियंता नाव',isNULL ('','') as 'ठेकेदार नाव',isNULL ('','')as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',isNULL ('','')as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक ',isNULL ('','') as 'कामाचा वाव',isNULL ('','') as 'कार्यांरभ आदेश/दिनांक',sum(cast(a.[NividaAmt] as decimal(10,2))) as 'निविदा रक्कम % कमी / जास्त',isNULL ('','') as 'बांधकाम कालावधी',isNULL ('','') as 'काम पूर्ण तारीख',isNULL ('','') as 'मुदतवाढ दिनांक',sum(CAST(CASE WHEN a.[LekhaShirsh] = N'५०५४४२४६'  THEN 1 ELSE 0 END as decimal(10,0))) as 'एकूण कामे',sum(b.[ManjurAmt] )as 'सन 2017-2018 मधील अपेक्षित खर्च',sum(b.[MarchEndingExpn]) as 'मार्च अखेर खर्च 2017',sum(b.[UrvaritAmt]) as 'उर्वरित किंमत (6-(8+9))',sum(b.[Chalukharch]) as 'एकुण उपलब्ध अनुदान',sum(b.[Magilkharch]) as 'सन 2016 - 17  06/2016 अखेर खर्च',sum(b.[VarshbharatilKharch]) as 'सन 2017-18 मधील माहे एप्रिल/मे अखेरचा खर्च',sum(b.[AikunKharch]) as 'एकुण कामावरील खर्च',sum(b.[Takunone]) as 'प्रथम तिमाही तरतूद',sum(b.[Takuntwo]) as 'द्वितीय तिमाही तरतूद',sum(b.[Takunthree]) as 'तृतीय तिमाही तरतूद',sum(b.[Takunfour]) as 'चतुर्थ तिमाही तरतूद',sum(b.[Tartud]) as 'काम निहाय तरतूद सन 2017-2018',sum(b.[AkunAnudan]) as 'वितरीत तरतूद सन 2017-2018',sum(b.[Magni]) as 'मागणी 2017-18',sum(b.[Vidyutprama]) as 'विद्युतप्रमा',sum(b.[Vidyutvitarit]) as 'विद्युत वितरीत',sum(b.[Itarkhrch]) as 'इतर खर्च',isNULL ('','') as 'द्वीगुणी',isNULL ('','') as 'पाहणीमुद्ये',isNULL ('','') as 'पाहणी क्रमांक',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Completed'  THEN 1 ELSE 0 END as decimal(10,0))) as 'पुर्ण',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Processing'  THEN 1 ELSE 0 END as decimal(10,0))) as 'प्रगतीत',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Not Started'  THEN 1 ELSE 0 END as decimal(10,0))) as 'निविदा स्तर',isNULL ('','') as 'शेरा',sum (b.[Apr]) as [Apr],sum (b.[May]) as [May],sum (b.[Jun]) as [Jun],sum (b.[Jul]) as [Jul],sum (b.[Aug]) as [Aug],sum (b.[Sep]) as [Sep],sum (b.[Oct]) as [Oct],sum (b.[Nov]) as [Nov],sum (b.[Dec]) as [Dec],sum (b.[Jan]) as [Jan],sum (b.[Feb]) as [Feb],sum (b.[Mar]) as [Mar] from BudgetMasterMLA as a join MLAProvision as b on a.WorkId=b.WorkId " + whereCondi + groupBy;
            Complet = query + unionQuery;
            return Complet;
        }

        public string Mp(string whereCondi, string groupBy)
        {
            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[KhasdaracheName] order by a.[KhasdaracheName],a.[Arthsankalpiyyear],a.[Taluka],a.[PageNo] ) as 'अ क्र', a.[WorkId] as 'वर्क आयडी',a.[Taluka] as 'तालुका',a.[AmdaracheName] as 'आमदारांचे नाव',a.[KhasdaracheName] as 'खासदारांचे नाव',a.[Arthsankalpiyyear] as 'अर्थसंकल्पीय बाब क्र./प्रथम समाविष्ट झालेल्या वर्ष',a.[PageNo] as 'प्रकार',a.[Type] as 'जिल्हा/योजना',a.[KamacheName] as 'कामाचे नाव',a.[Upvibhag] as 'उपविभाग',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'शाखा अभियंता नाव',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'उपअभियंता नाव',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'ठेकेदार नाव',convert(nvarchar(max),a.[PrashaskiyKramank])+' '+convert(nvarchar(max),a.[PrashaskiyAmt])+' '+convert(nvarchar(max),a.[PrashaskiyDate])as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',convert(nvarchar(max),a.[TrantrikKrmank])+' '+convert(nvarchar(max),a.[TrantrikAmt])+' '+convert(nvarchar(max),a.[TrantrikDate])as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',a.[Kamachevav] as 'कामाचा वाव',convert(nvarchar(max),a.[NividaKrmank])+' '+convert(nvarchar(max),a.[NividaDate])as 'कार्यांरभ आदेश/दिनांक',cast(a.[NividaAmt] as decimal(10,2)) as 'निविदा रक्कम % कमी / जास्त',a.[kamachiMudat] as 'बांधकाम कालावधी',a.[KamPurnDate] as 'काम पूर्ण तारीख',CAST(CASE WHEN a.[LekhaShirsh] = N'५०५४४२४६'  THEN 1 ELSE 0 END as decimal(10,0)) as 'एकूण कामे',b.[MudatVadhiDate] as 'मुदतवाढ दिनांक',b.[ManjurAmt] as 'सन 2017-18 मधील अपेक्षित खर्च',b.[MarchEndingExpn] as 'मार्च अखेर खर्च 2017',b.[UrvaritAmt] as 'उर्वरित किंमत (6-(8+9))',b.[Chalukharch] as 'एकुण उपलब्ध अनुदान',b.[Takunone] as 'प्रथम तिमाही तरतूद',b.[Takuntwo] as 'द्वितीय तिमाही तरतूद',b.[Takunthree] as 'तृतीय तिमाही तरतूद',b.[Takunfour] as 'चतुर्थ तिमाही तरतूद',b.[Magilkharch] as 'मागील खर्च',b.[VarshbharatilKharch] as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेरचा खर्च',b.[AikunKharch] as 'एकुण खर्च',b.[Tartud] as 'एकूण अर्थसंकल्पीय तरतूद',b.[AkunAnudan] as '2017-18 मधील वितरीत तरतूद',b.[Magni] as 'मागणी  2017-18',b.[Vidyutprama] as 'विद्युतप्रमा',b.[Vidyutvitarit] as 'विद्युत वितरीत',b.[Itarkhrch] as 'इतर खर्च',b.[Dviguni] as 'द्वीगुणी',a.[Pahanikramank] as 'पाहणी क्रमांक',a.[PahaniMudye] as 'पाहणीमुद्ये',CAST(CASE WHEN a.[Sadyasthiti] = 'Completed'  THEN 1 ELSE 0 END as decimal(10,0)) as 'पुर्ण',CAST(CASE WHEN a.[Sadyasthiti] = 'Processing'  THEN 1 ELSE 0 END as decimal(10,0)) as 'प्रगतीत',CAST(CASE WHEN a.[Sadyasthiti] = 'Not Started'  THEN 1 ELSE 0 END as decimal(10,0)) as 'निविदा स्तर',a.[Shera] as 'शेरा',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterMP as a join MPProvision as b on a.WorkId=b.WorkId " + whereCondi;
            unionQuery = " union select isNULL ('','')as'अ क्र', 'Total' as 'वर्क आयडी',isNULL ('','') as 'तालुका',isNULL ('','') as 'आमदारांचे नाव',isNULL (a.[KhasdaracheName],'') as 'खासदारांचे नाव',isNULL ('Total','') as 'अर्थसंकल्पीय बाब क्र./प्रथम समाविष्ट झालेल्या वर्ष',isNULL ('','') as 'प्रकार',isNULL ('','') as 'जिल्हा/योजना',isNULL ('','') as 'कामाचे नाव',isNULL ('','') as 'उपविभाग',isNULL ('','') as 'शाखा अभियंता नाव',isNULL ('','') as 'उपअभियंता नाव',isNULL ('','') as 'ठेकेदार नाव',isNULL ('','')as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',isNULL ('','')as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक ',isNULL ('','') as 'कामाचा वाव',isNULL ('','') as 'कार्यांरभ आदेश/दिनांक',sum(cast(a.[NividaAmt] as decimal(10,2))) as 'निविदा रक्कम % कमी / जास्त',isNULL ('','') as 'बांधकाम कालावधी',isNULL ('','') as 'काम पूर्ण तारीख',sum(CAST(CASE WHEN a.[LekhaShirsh] = N'५०५४४२४६'  THEN 1 ELSE 0 END as decimal(10,0))) as 'एकूण कामे',isNULL ('','') as 'मुदतवाढ दिनांक',sum(b.[ManjurAmt] )as 'सन 2017-18 मधील अपेक्षित खर्च',sum(b.[MarchEndingExpn]) as 'मार्च अखेर खर्च 2017',sum(b.[UrvaritAmt]) as 'उर्वरित किंमत (6-(8+9))',sum(b.[Chalukharch]) as 'एकुण उपलब्ध अनुदान',sum(b.[Takunone]) as 'प्रथम तिमाही तरतूद',sum(b.[Takuntwo]) as 'द्वितीय तिमाही तरतूद',sum(b.[Takunthree]) as 'तृतीय तिमाही तरतूद',sum(b.[Takunfour]) as 'चतुर्थ तिमाही तरतूद',sum(b.[Magilkharch]) as 'मागील खर्च',sum(b.[VarshbharatilKharch]) as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेरचा खर्च',sum(b.[AikunKharch]) as 'एकुण खर्च',sum(b.[Tartud]) as 'एकूण अर्थसंकल्पीय तरतूद',sum(b.[AkunAnudan]) as '2017-18 मधील वितरीत तरतूद',sum(b.[Magni]) as 'मागणी  2017-18',sum(b.[Vidyutprama]) as 'विद्युतप्रमा',sum(b.[Vidyutvitarit]) as 'विद्युत वितरीत',sum(b.[Itarkhrch]) as 'इतर खर्च',isNULL ('','') as 'द्वीगुणी',isNULL ('','') as 'पाहणी क्रमांक',isNULL ('','') as 'पाहणीमुद्ये',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Completed'  THEN 1 ELSE 0 END as decimal(10,0))) as 'पुर्ण',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Processing'  THEN 1 ELSE 0 END as decimal(10,0))) as 'प्रगतीत',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Not Started'  THEN 1 ELSE 0 END as decimal(10,0))) as 'निविदा स्तर',isNULL ('','') as 'शेरा',sum (b.[Apr]) as [Apr],sum (b.[May]) as [May],sum (b.[Jun]) as [Jun],sum (b.[Jul]) as [Jul],sum (b.[Aug]) as [Aug],sum (b.[Sep]) as [Sep],sum (b.[Oct]) as [Oct],sum (b.[Nov]) as [Nov],sum (b.[Dec]) as [Dec],sum (b.[Jan]) as [Jan],sum (b.[Feb]) as [Feb],sum (b.[Mar]) as [Mar] from BudgetMasterMP as a join MPProvision as b on a.WorkId=b.WorkId " + whereCondi + groupBy;
            Complet = query + unionQuery;
            return Complet;
        }

        public string Annuity(string whereCondi, string groupBy)
        {
            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[Arthsankalpiyyear],a.[Upvibhag] ORDER BY a.[Arthsankalpiyyear],a.[upvibhag],a.[Taluka] desc) as 'अ क्र', a.[WorkId] as 'वर्क आयडी',a.PageNo as 'पेज क्र',a.ArthsankalpiyBab as 'बाब क्र',a.JulyBab as 'जुलै/ बाब क्र./पान क्र.',a.[Arthsankalpiyyear] as 'अर्थसंकल्पीय वर्ष',a.[KamacheName] as 'कामाचे नाव',a.[LekhaShirshName] as 'लेखाशीर्ष नाव',a.[SubType] as 'विभाग',a.[Upvibhag] as 'उपविभाग',a.[Taluka] as 'तालुका',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile])as 'शाखा अभियंता नाव',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile])as 'उपअभियंता नाव',a.[AmdaracheName] as 'आमदारांचे नाव',a.[KhasdaracheName] as 'खासदारांचे नाव',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'ठेकेदार नाव',convert(nvarchar(max),a.[PrashaskiyKramank])+' '+convert(nvarchar(max),a.[PrashaskiyAmt])+' '+convert(nvarchar(max),a.[PrashaskiyDate])as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',convert(nvarchar(max),a.[TrantrikKrmank])+' '+convert(nvarchar(max),a.[TrantrikAmt])+' '+convert(nvarchar(max),a.[TrantrikDate])as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',a.[Kamachevav] as 'कामाचा वाव',convert(nvarchar(max),a.[NividaKrmank])+' '+convert(nvarchar(max),a.[NividaDate])as 'निविदा क्र/दिनांक',cast(a.[NividaAmt] as decimal(10,2)) as 'निविदा रक्कम % कमी / जास्त',a.[karyarambhadesh] as 'कार्यारंभ आदेश',a.[kamachiMudat] as 'बांधकाम कालावधी',a.[KamPurnDate] as 'काम पूर्ण तारीख',CAST(CASE WHEN b.[MudatVadhiDate] = ' ' or b.[MudatVadhiDate] = '0' THEN N'होय' ELSE N'नाही' END as nvarchar(max)) as 'मुदतवाढ बाबत',b.[ManjurAmt] as 'मंजूर अंदाजित किंमत',b.[MarchEndingExpn] as 'मार्च अखेर खर्च 2017',b.[UrvaritAmt] as 'उर्वरित किंमत',b.[Chalukharch] as 'चालु खर्च',b.[Magilkharch] as 'मागील खर्च',b.[VarshbharatilKharch] as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेरचा खर्च',b.[AikunKharch] as 'एकुण कामावरील खर्च',b.[Takunone] as'2017-18 मधील अर्थसंकल्पीय तरतूद मार्च 2017',b.[Takuntwo] as '2016-17 मधील अर्थसंकल्पीय तरतूद जुलै 2016',b.[Takunthree] as 'तृतीय तिमाही तरतूद',b.[Takunfour] as 'चतुर्थ तिमाही तरतूद',b.[Tartud] as 'एकूण अर्थसंकल्पीय तरतूद',b.[Magni] as '2016-17 साठी मागणी',b.[Vidyutprama] as 'विद्युतीकरणावरील प्रमा',b.[Vidyutvitarit] as 'विद्युतीकरणावरील वितरित',b.[Itarkhrch] as 'इतर खर्च',b.[Dviguni] as 'दवगुनी ज्ञापने',a.[Pahanikramank] as 'पाहणी क्रमांक',a.[PahaniMudye] as 'पाहणीमुद्ये',b.[DeyakachiSadyasthiti] as 'देयकाची सद्यस्थिती',CAST(CASE WHEN a.[Sadyasthiti] = 'Completed'  THEN 1 ELSE 0 END as decimal(10,0)) as 'C',CAST(CASE WHEN a.[Sadyasthiti] = 'Processing'  THEN 1 ELSE 0 END as decimal(10,0)) as 'P',CAST(CASE WHEN a.[Sadyasthiti] = 'Not Started'  THEN 1 ELSE 0 END as decimal(10,0)) as 'NS',convert(nvarchar(max),a.[Sadyasthiti])+' '+convert(nvarchar(max),a.[Shera]) as 'शेरा',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterAunty as a join AuntyProvision as b on a.WorkId=b.WorkId " + whereCondi;
            unionQuery = " union select isNULL ('','')as'अ क्र', 'Total' as 'वर्क आयडी',isNULL ('','') as 'पेज क्र',isNULL ('','') as 'बाब क्र',isNULL ('','') as 'जुलै/ बाब क्र./पान क्र.',isNULL (a.[Arthsankalpiyyear],'') as 'अर्थसंकल्पीय वर्ष',isNULL ('','') as 'कामाचे नाव',isNULL ('','') as 'लेखाशीर्ष नाव',isNULL ('','') as 'विभाग',isNULL (a.[Upvibhag],'') as 'उपविभाग',isNULL ('','') as 'तालुका',isNULL ('','') as 'शाखा अभियंता नाव',isNULL ('','') as 'उपअभियंता नाव',isNULL ('','') as 'आमदारांचे नाव',isNULL ('','') as 'खासदारांचे नाव',isNULL ('','') as 'ठेकेदार नाव',isNULL ('','') as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'कामाचा वाव',isNULL ('','') as 'निविदा क्र/दिनांक',sum(cast(a.[NividaAmt] as decimal(10,2))) as 'निविदा रक्कम % कमी / जास्त',isNULL ('','') as 'कार्यारंभ आदेश',isNULL ('','') as 'बांधकाम कालावधी',isNULL ('','') as 'काम पूर्ण तारीख',isNULL ('','') as 'मुदतवाढ बाबत',sum(b.[ManjurAmt]) as 'मंजूर अंदाजित किंमत',sum(b.[MarchEndingExpn]) as 'मार्च अखेर खर्च 2017',sum(b.[UrvaritAmt]) as 'उर्वरित किंमत',sum(b.[Chalukharch])as 'चालु खर्च',sum(b.[Magilkharch]) as 'मागील खर्च ',sum(b.[VarshbharatilKharch]) as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेरचा खर्च',sum(b.[AikunKharch]) as 'एकुण कामावरील खर्च',sum(b.[Takunone]) as'2017-18 मधील अर्थसंकल्पीय तरतूद मार्च 2017',sum(b.[Takuntwo]) as '2016-17 मधील अर्थसंकल्पीय तरतूद जुलै 2016',sum(b.[Takunthree]) as 'तृतीय तिमाही तरतूद',sum(b.[Takunfour]) as 'चतुर्थ तिमाही तरतूद',sum(b.[Tartud]) as 'एकूण अर्थसंकल्पीय तरतूद',sum(b.[Magni]) as '2016-17 साठी मागणी',sum(b.[Vidyutprama]) as 'प्रमा',sum(b.[Vidyutvitarit]) as 'वितरित',sum(b.[Itarkhrch]) as 'इतर खर्च',isNULL ('','') as 'दवगुनी ज्ञापने',isNULL ('','') as 'पाहणी क्रमांक',isNULL ('','') as 'पाहणीमुद्ये',isNULL ('','') as 'देयकाची सद्यस्थिती',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Completed'  THEN 1 ELSE 0 END as decimal(10,0))) as 'C',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Processing'  THEN 1 ELSE 0 END as decimal(10,0))) as 'P',sum(CAST(CASE WHEN a.[Sadyasthiti] = 'Not Started'  THEN 1 ELSE 0 END as decimal(10,0))) as 'NS',isNULL ('','') as 'शेरा',sum (b.[Apr]) as [Apr],sum (b.[May]) as [May],sum (b.[Jun]) as [Jun],sum (b.[Jul]) as [Jul],sum (b.[Aug]) as [Aug],sum (b.[Sep]) as [Sep],sum (b.[Oct]) as [Oct],sum (b.[Nov]) as [Nov],sum (b.[Dec]) as [Dec],sum (b.[Jan]) as [Jan],sum (b.[Feb]) as [Feb],sum (b.[Mar]) as [Mar] from BudgetMasterAunty as a join AuntyProvision as b on a.WorkId=b.WorkId " + whereCondi + groupBy;
            Complet = query + unionQuery;
            return Complet;
        }

        public string Deposite(string whereCondi, string groupBy)
        {
            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[LekhaShirshName],a.[Arthsankalpiyyear] ORDER BY a.[Arthsankalpiyyear],a.[upvibhag]desc) as 'अ क्र', a.[WorkId] as 'वर्क आयडी',a.[ArthsankalpiyBab] as 'अर्थसंकल्पीय बाब',a.[Arthsankalpiyyear] as 'अर्थसंकल्पीय वर्ष',a.[KamacheName] as 'कामाचे नाव',a.[LekhaShirshName] as 'लेखाशीर्ष नाव',a.[SubType] as 'विभाग',a.[Upvibhag] as 'उपविभाग',a.[Taluka] as 'तालुका',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'शाखा अभियंता नाव',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'उपअभियंता नाव',a.[AmdaracheName] as 'आमदारांचे नाव',a.[KhasdaracheName] as 'खासदारांचे नाव',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'ठेकेदार नाव',convert(nvarchar(max),a.[PrashaskiyKramank])+' '+convert(nvarchar(max),a.[PrashaskiyAmt])+' '+convert(nvarchar(max),a.[PrashaskiyDate])as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',convert(nvarchar(max),a.[TrantrikKrmank])+' '+convert(nvarchar(max),a.[TrantrikAmt])+' '+convert(nvarchar(max),a.[TrantrikDate])as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',a.[Kamachevav] as 'कामाचा वाव',convert(nvarchar(max),a.[NividaKrmank])+' '+convert(nvarchar(max),a.[NividaDate])as 'कार्यारंभ आदेश',a.[NividaAmt] as 'निविदा रक्कम % कमी / जास्त',a.[kamachiMudat] as 'बांधकाम कालावधी',a.[KamPurnDate] as 'काम पूर्ण तारीख',CAST(CASE WHEN b.[MudatVadhiDate] = ' ' or b.[MudatVadhiDate] = '0' THEN N'होय' ELSE N'नाही' END as nvarchar(max)) as 'मुदतवाढ बाबत',b.[ManjurAmt] as 'मंजूर अंदाजित किंमत',b.[MarchEndingExpn] as 'मार्च अखेर खर्च 2017',b.[UrvaritAmt] as 'उर्वरित किंमत',b.[VarshbharatilKharch] as 'सन 2017-18 मधील माहे एप्रिल/मे अखेरचा खर्च',b.[Magilkharch] as 'मागील खर्च',b.[Chalukharch] as 'चालू खर्च',b.[AikunKharch] as 'एकुण कामावरील खर्च',b.[Takunone] as 'प्रथम तिमाही तरतूद',b.[Takuntwo] as 'द्वितीय तिमाही तरतूद',b.[Takunthree] as 'तृतीय तिमाही तरतूद',b.[Takunfour] as 'चतुर्थ तिमाही तरतूद',b.[Tartud]as 'अर्थसंकल्पीय तरतूद',b.[AkunAnudan] as 'वितरित तरतूद',b.[Magni] as 'मागणी',b.[Vidyutprama] as 'विद्युतीकरणावरील प्रमा',b.[Vidyutvitarit] as 'विद्युतीकरणावरील वितरित',b.[Itarkhrch] as 'इतर खर्च',b.ShilakThev as '2017-18 मधील शिल्लक ठेव',b.VitariThev as '2017-18 वितरीत ठेव',b.[Dviguni] as 'दवगुनी ज्ञापने',a.[PahaniMudye] as 'पाहणीमुद्ये',a.[Pahanikramank] as 'पाहणी क्रमांक',b.[DeyakachiSadyasthiti] as 'देयकाची सद्यस्थिती',convert(nvarchar(max),a.[Sadyasthiti])+' '+convert(nvarchar(max),a.[Shera]) as 'शेरा',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterDepositFund as a join DepositFundProvision as b on a.WorkId=b.WorkId " + whereCondi;
            unionQuery = " union select isNULL ('','')as'अ क्र', 'Total' as 'वर्क आयडी',isNULL ('','') as 'अर्थसंकल्पीय बाब',isNULL (a.[Arthsankalpiyyear],'') as 'अर्थसंकल्पीय वर्ष',isNULL ('','') as 'कामाचे नाव',isNULL ('','') as 'लेखाशीर्ष नाव',isNULL ('','') as 'विभाग',isNULL ('','') as 'उपविभाग',isNULL ('','0') as 'तालुका',isNULL ('','') as 'शाखा अभियंता नाव',isNULL ('','') as 'उपअभियंता नाव',isNULL ('','') as 'आमदारांचे नाव',isNULL ('','') as 'खासदारांचे नाव',isNULL ('','') as 'ठेकेदार नाव',isNULL ('','') as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक ',isNULL ('','') as 'कामाचा वाव',isNULL ('','') as 'कार्यारंभ आदेश',isNULL ('','') as 'निविदा रक्कम % कमी / जास्त',isNULL ('','') as 'बांधकाम कालावधी',isNULL ('','') as 'काम पूर्ण तारीख',isNULL ('','') as 'मुदतवाढ बाबत',sum(b.[ManjurAmt]) as 'मंजूर अंदाजित किंमत',sum(b.[MarchEndingExpn])as 'मार्च अखेर खर्च 2017',sum(b.[UrvaritAmt]) as 'उर्वरित किंमत',sum(b.[VarshbharatilKharch]) as 'सन 2017-18 मधील माहे एप्रिल/मे अखेरचा खर्च',sum(b.[Magilkharch])as 'मागील खर्च',sum(b.[Chalukharch])as 'चालू खर्च',sum(b.[AikunKharch]) as 'एकुण कामावरील खर्च',sum(b.[Takunone]) as 'प्रथम तिमाही तरतूद',sum(b.[Takuntwo]) as 'द्वितीय तिमाही तरतूद',sum(b.[Takunthree]) as 'तृतीय तिमाही तरतूद',sum(b.[Takunfour]) as 'चतुर्थ तिमाही तरतूद',sum(b.[Tartud])as 'अर्थसंकल्पीय तरतूद',sum(b.[AkunAnudan]) as 'वितरित तरतूद',sum(b.[Magni]) as 'मागणी',sum(b.[Vidyutprama]) as 'प्रमा',sum(b.[Vidyutvitarit]) as 'वितरित',sum(b.[Itarkhrch]) as 'इतर खर्च',sum(b.ShilakThev) as '2017-18 मधील शिल्लक ठेव ',sum(b.VitariThev) as '2017-18 वितरीत ठेव',isNULL ('','') as 'दवगुनी ज्ञापने',isNULL ('','') as 'पाहणीमुद्ये',isNULL ('','') as 'पाहणी क्रमांक',isNULL ('','') as 'देयकाची सद्यस्थिती',isNULL ('','') as 'शेरा',sum (b.[Apr]) as [Apr],sum (b.[May]) as [May],sum (b.[Jun]) as [Jun],sum (b.[Jul]) as [Jul],sum (b.[Aug]) as [Aug],sum (b.[Sep]) as [Sep],sum (b.[Oct]) as [Oct],sum (b.[Nov]) as [Nov],sum (b.[Dec]) as [Dec],sum (b.[Jan]) as [Jan],sum (b.[Feb]) as [Feb],sum (b.[Mar]) as [Mar] from BudgetMasterDepositFund as a join DepositFundProvision as b on a.WorkId=b.WorkId " + whereCondi + groupBy;
            Complet = query + unionQuery;
            return Complet;
        }

        public string GatA(string whereCondi, string groupBy)
        {
            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[LekhaShirshName],a.[Arthsankalpiyyear] ORDER BY a.[Arthsankalpiyyear],    CASE WHEN ISNUMERIC(a.[ArthsankalpiyBab]) = 1 THEN 0 ELSE 1 END,    CASE WHEN ISNUMERIC(a.[ArthsankalpiyBab]) = 1 THEN CAST(a.[ArthsankalpiyBab] AS INT) ELSE 0 END,a.[ArthsankalpiyBab],a.[Upvibhag],a.taluka) as 'अ क्र', a.[WorkId] as 'वर्क आयडी',a.[Arthsankalpiyyear] as 'अर्थसंकल्पीय वर्ष',a.[KamacheName] as 'कामाचे नाव',a.[LekhaShirshName] as 'लेखाशीर्ष नाव',a.[SubType] as 'विभाग',a.[Upvibhag] as 'उपविभाग',a.[Taluka] as 'तालुका',a.[ArthsankalpiyBab] as 'अर्थसंकल्पीय बाब',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'शाखा अभियंता नाव',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'उपअभियंता नाव',a.[AmdaracheName] as 'आमदारांचे नाव',a.[KhasdaracheName] as 'खासदारांचे नाव',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'ठेकेदार नाव',convert(nvarchar(max),a.[PrashaskiyKramank])+' '+convert(nvarchar(max),a.[PrashaskiyAmt])+' '+convert(nvarchar(max),a.[PrashaskiyDate])as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',convert(nvarchar(max),a.[TrantrikKrmank])+' '+convert(nvarchar(max),a.[TrantrikAmt])+' '+convert(nvarchar(max),a.[TrantrikDate])as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',a.[Kamachevav] as 'कामाचा वाव',convert(nvarchar(max),a.[NividaKrmank])+' '+convert(nvarchar(max),a.[NividaDate])as 'कार्यारंभ आदेश',cast(a.[NividaAmt] as decimal(10,2)) as 'निविदा रक्कम % कमी / जास्त',a.[kamachiMudat] as 'बांधकाम कालावधी',a.[KamPurnDate] as 'काम पूर्ण तारीख',CAST(CASE WHEN b.[MudatVadhiDate] = ' ' or b.[MudatVadhiDate] = '0' THEN N'होय' ELSE N'नाही' END as nvarchar(max)) as 'मुदतवाढ बाबत',b.[ManjurAmt] as 'मंजूर अंदाजित किंमत',b.[MarchEndingExpn] as 'मार्च अखेर खर्च 2017',b.[UrvaritAmt] as 'उर्वरित किंमत',b.[Chalukharch] as 'चालू खर्च',b.[Magilkharch] as 'मागील खर्च',b.[VarshbharatilKharch] as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेर खर्च',b.[AikunKharch] as 'एकुण कामावरील खर्च',b.[Takunone] as 'प्रथम तिमाही तरतूद',b.[Takuntwo] as 'द्वितीय तिमाही तरतूद',b.[Takunthree] as 'तृतीय तिमाही तरतूद',b.[Takunfour] as 'चतुर्थ तिमाही तरतूद',b.[Tartud]as 'अर्थसंकल्पीय तरतूद',b.[AkunAnudan] as 'वितरित तरतूद',b.[Magni] as 'मागणी',b.[VidyutikaranAmt] as 'विद्युतीकरण कामाची किंमत',b.[VidyutikaranExpen] as 'विद्युतीकरणाचा खर्च',a.[GAadeshKramank] as 'आदेश क्र',a.[GUpshirsh] as 'उपशिर्ष',a.[GJobKramank] as 'जॉब क्र',a.[GJobRakkam] as 'जॉब रक्कम',a.[GDambarichePariman] as 'डांबरीचे परिमाण',a.[GDambarichiRakkam] as 'डांबरीची रक्कम',a.[GDurustichaprakar] as 'दुरुस्तीचा प्रकार',cast(a.[GVaperDambarichePariman] as decimal(10,2)) as 'वापर डांबरीचे परिमाण',a.[GKampurnKarnyachaDinak] as 'डांबरीचे काम पूर्ण दिनांक',a.[GKampurnJhalyachaDinak] as 'डांबरीचे काम पूर्ण झाल्याच्या दिनांक',a.[GDeyakSadarKelyachaDinak] as 'विभागात देयक सादर दिनांक',a.[GParitKelyachaDinak] as 'विभागात देयक पारित दिनांक',b.[ShilakDayitvAmt] as 'शिल्लक दायित्व रु',b.[DayitvAvshyakYesNo] as 'दायित्व आवश्यकता आहे / नाही',b.[DayitvAmt] as 'दायित्व असल्यास रक्कम रु',b.[DambarichaExpen] as 'डांबरीचा खर्च',b.[Itarkhrch] as 'इतर खर्च',b.[Dviguni] as 'द्वीगुणी',a.[Pahanikramank] as 'पाहणीक्रमांक',a.[PahaniMudye] as 'पाहणीमुद्ये',convert(nvarchar(max),a.[Sadyasthiti])+' '+convert(nvarchar(max),a.[Shera]) as 'शेरा',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterGAT_A as a join GAT_AProvision as b on a.WorkId=b.WorkId  " + whereCondi;
            unionQuery = " union select isNULL ('','')as'अ क्र', 'Total' as 'वर्क आयडी',isNULL ('Total','') as 'अर्थसंकल्पीय वर्ष',isNULL ('','') as 'कामाचे नाव',isNULL ('','') as 'लेखाशीर्ष नाव',isNULL ('','') as 'विभाग',isNULL ('Total','') as 'उपविभाग',isNULL ('','') as 'तालुका',sum( cast(a.[ArthsankalpiyBab] as int)) as 'अर्थसंकल्पीय बाब',isNULL ('','') as 'शाखा अभियंता नाव',isNULL ('','') as 'उपअभियंता नाव',isNULL ('','') as 'आमदारांचे नाव',isNULL ('','') as 'खासदारांचे नाव',isNULL ('','') as 'ठेकेदार नाव',isNULL ('','') as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक ',isNULL ('','') as 'कामाचा वाव',isNULL ('','') as 'कार्यारंभ आदेश',sum(cast(a.[NividaAmt] as decimal(10,2))) as 'निविदा रक्कम % कमी / जास्त',isNULL ('','') as 'बांधकाम कालावधी',isNULL ('','') as 'काम पूर्ण तारीख',isNULL ('','') as 'मुदतवाढ बाबत',sum(b.[ManjurAmt]) as 'मंजूर अंदाजित किंमत',sum(b.[MarchEndingExpn])as 'मार्च अखेर खर्च 2017',sum(b.[UrvaritAmt]) as 'उर्वरित किंमत',sum(b.[Chalukharch])as 'चालू खर्च',sum(b.[Magilkharch]) as 'मागील खर्च',sum(b.[VarshbharatilKharch]) as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेर खर्च',sum(b.[AikunKharch]) as 'एकुण कामावरील खर्च',sum(b.[Takunone]) as 'प्रथम तिमाही तरतूद',sum(b.[Takuntwo]) as 'द्वितीय तिमाही तरतूद',sum(b.[Takunthree]) as 'तृतीय तिमाही तरतूद',sum(b.[Takunfour]) as 'चतुर्थ तिमाही तरतूद',sum(b.[Tartud])as 'अर्थसंकल्पीय तरतूद',sum(b.[AkunAnudan]) as 'वितरित तरतूद',sum(b.[Magni]) as 'मागणी',sum(b.[VidyutikaranAmt]) as 'विद्युतीकरण कामाची किंमत',sum(b.[VidyutikaranExpen]) as 'विद्युतीकरणाचा खर्च',isNULL ('','') as 'आदेश क्र',isNULL ('','') as 'उपशिर्ष',isNULL ('','') as 'जॉब क्र',sum(a.[GJobRakkam]) as 'जॉब रक्कम',sum(a.[GDambarichePariman]) as 'डांबरीचे परिमाण',sum(a.[GDambarichiRakkam]) as 'डांबरीची रक्कम',isNULL ('','') as 'दुरुस्तीचा प्रकार',sum(cast(a.[GVaperDambarichePariman] as decimal(10,2))) as 'वापर डांबरीचे परिमाण',isNULL ('','') as 'डांबरीचे काम पूर्ण दिनांक',isNULL ('','') as 'डांबरीचे काम पूर्ण झाल्याच्या दिनांक',isNULL ('','') as 'विभागात देयक सादर दिनांक',isNULL ('','') as 'विभागात देयक पारित दिनांक',sum(b.[ShilakDayitvAmt]) as 'शिल्लक दायित्व रु',isNULL ('','') as 'दायित्व आवश्यकता आहे / नाही',sum(b.[DayitvAmt]) as 'दायित्व असल्यास रक्कम रु',sum(b.[DambarichaExpen]) as 'डांबरीचा खर्च',sum(b.[Itarkhrch]) as 'इतर खर्च',isNULL ('','') as 'द्वीगुणी',isNULL ('','') as 'पाहणीक्रमांक',isNULL ('','') as 'पाहणीमुद्ये',isNULL ('','') as 'शेरा',sum (b.[Apr]) as [Apr],sum (b.[May]) as [May],sum (b.[Jun]) as [Jun],sum (b.[Jul]) as [Jul],sum (b.[Aug]) as [Aug],sum (b.[Sep]) as [Sep],sum (b.[Oct]) as [Oct],sum (b.[Nov]) as [Nov],sum (b.[Dec]) as [Dec],sum (b.[Jan]) as [Jan],sum (b.[Feb]) as [Feb],sum (b.[Mar]) as [Mar]from BudgetMasterGAT_A as a join GAT_AProvision as b on a.WorkId=b.WorkId " + whereCondi + groupBy;
            Complet = query + unionQuery;
            return Complet;
        }

        public string GatD(string whereCondi, string groupBy)
        {
            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[LekhaShirshName],a.[Arthsankalpiyyear],a.[Upvibhag] ORDER BY a.[LekhaShirshName],a.[Arthsankalpiyyear],a.[upvibhag],a.[Taluka]desc) as 'अ क्र', a.[WorkId] as 'वर्क आयडी',a.[Arthsankalpiyyear] as 'अर्थसंकल्पीय वर्ष',a.[KamacheName] as 'कामाचे नाव',a.[LekhaShirshName] as 'लेखशीर्ष नाव',a.[SubType] as 'विभाग',a.[Upvibhag] as 'उपविभाग',a.[Taluka] as 'तालुका',a.[ArthsankalpiyBab] as 'अर्थसंकल्पीय बाब',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'शाखा अभियंता नाव',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'उपअभियंता नाव',a.[AmdaracheName] as 'आमदारांचे नाव',a.[KhasdaracheName] as 'खासदारांचे नाव',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'ठेकेदार नाव',convert(nvarchar(max),a.[PrashaskiyKramank])+' '+convert(nvarchar(max),a.[PrashaskiyAmt])+' '+convert(nvarchar(max),a.[PrashaskiyDate])as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',convert(nvarchar(max),a.[TrantrikKrmank])+' '+convert(nvarchar(max),a.[TrantrikAmt])+' '+convert(nvarchar(max),a.[TrantrikDate])as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',a.[Kamachevav] as 'कामाचा वाव',a.[karyarambhadesh] as 'कार्यारंभ आदेश',convert(nvarchar(max),a.[NividaKrmank])+' '+convert(nvarchar(max),a.[NividaDate])as 'निविदा क्र/दिनांक',cast(a.[NividaAmt] as decimal(10,2)) as 'निविदा रक्कम % कमी / जास्त',a.[kamachiMudat] as 'बांधकाम कालावधी',a.[KamPurnDate] as 'काम पूर्ण तारीख',CAST(CASE WHEN b.[MudatVadhiDate] = ' ' or b.[MudatVadhiDate] = '0' THEN N'होय' ELSE N'नाही' END as nvarchar(max)) as 'मुदतवाढ बाबत',b.[ManjurAmt] as 'मंजूर अंदाजित किंमत',b.[MarchEndingExpn] as 'मार्च अखेर खर्च 2017',b.[UrvaritAmt] as 'उर्वरित किंमत',b.[Chalukharch] as 'चालू खर्च',b.[Magilkharch] as 'मागील खर्च',b.[VarshbharatilKharch] as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेर खर्च',b.[AikunKharch] as 'एकुण कामावरील खर्च',b.[Takunone] as 'प्रथम तिमाही तरतूद',b.[Takuntwo] as 'द्वितीय तिमाही तरतूद',b.[Takunthree] as 'तृतीय तिमाही तरतूद',b.[Takunfour] as 'चतुर्थ तिमाही तरतूद',b.[Tartud]as 'अर्थसंकल्पीय तरतूद',b.[AkunAnudan] as 'वितरित तरतूद',b.[Magni] as 'मागणी',b.[VidyutikaranAmt] as 'विद्युतीकरण कामाची किंमत',b.[VidyutikaranExpen] as 'विद्युतीकरणाचा खर्च',a.[ForDepartment] as 'शासनाने नेमुन दिलेले प्रादेशिक विभागासाठीचे लक्ष',a.[DepartmentDecided] as 'प्रादेशिक विभागाने निश्चित केलेले लक्ष',a.[FromAccident] as 'अपघात प्रवण ठिकाण पासुन',a.[AccidentExecuted] as 'अपघात प्रवण ठिकाण पर्यंत',a.[AccidentKaryvahi] as 'अपघात कार्यवाही',b.[Itarkhrch] as 'इतर खर्च',b.[Dviguni] as 'दवगुनी ज्ञापने',a.[Pahanikramank] as 'पाहणीक्रमांक',a.[PahaniMudye] as 'पाहणीमुद्ये',convert(nvarchar(max),a.[Sadyasthiti])+' '+convert(nvarchar(max),a.[Shera]) as 'शेरा',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterGAT_D as a join GAT_DProvision as b on a.WorkId=b.WorkId  " + whereCondi;
            unionQuery = " union select isNULL ('','')as'अ क्र', 'Total' as 'वर्क आयडी',isNULL (a.[Arthsankalpiyyear],'') as 'अर्थसंकल्पीय वर्ष',isNULL ('','') as 'कामाचे नाव',isNULL ('','') as 'लेखशीर्ष नाव',isNULL ('','') as 'विभाग',isNULL (a.[Upvibhag],'') as 'उपविभाग',isNULL ('','0') as 'तालुका',isNULL ('','') as 'अर्थसंकल्पीय बाब',isNULL ('','') as 'शाखा अभियंता नाव',isNULL ('','') as 'उपअभियंता नाव',isNULL ('','') as 'आमदारांचे नाव',isNULL ('','') as 'खासदारांचे नाव',isNULL ('','') as 'ठेकेदार नाव',isNULL ('','') as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक ',isNULL ('','') as 'कामाचा वाव',isNULL ('','') as 'कार्यारंभ आदेश',isNULL ('','') as 'निविदा क्र/दिनांक',sum(cast(a.[NividaAmt] as decimal(10,2))) as 'निविदा रक्कम % कमी / जास्त',isNULL ('','') as 'बांधकाम कालावधी',isNULL ('','') as 'काम पूर्ण तारीख',isNULL ('','') as 'मुदतवाढ बाबत',sum(b.[ManjurAmt]) as 'मंजूर अंदाजित किंमत',sum(b.[MarchEndingExpn])as 'मार्च अखेर खर्च 2017',sum(b.[UrvaritAmt]) as 'उर्वरित किंमत',sum(b.[Chalukharch])as 'चालू खर्च',sum(b.[Magilkharch])as 'मागील खर्च',sum(b.[VarshbharatilKharch]) as 'सन 2017-2018 मधील माहे एप्रिल/मे अखेर खर्च',sum(b.[AikunKharch]) as 'एकुण कामावरील खर्च',sum(b.[Takunone]) as 'प्रथम तिमाही तरतूद',sum(b.[Takuntwo]) as 'द्वितीय तिमाही तरतूद',sum(b.[Takunthree]) as 'तृतीय तिमाही तरतूद',sum(b.[Takunfour]) as 'चतुर्थ तिमाही तरतूद',sum(b.[Tartud])as 'अर्थसंकल्पीय तरतूद',sum(b.[AkunAnudan]) as 'वितरित तरतूद',sum(b.[Magni]) as 'मागणी',sum(b.[VidyutikaranAmt]) as 'विद्युतीकरण कामाची किंमत',sum(b.[VidyutikaranExpen]) as 'विद्युतीकरणाचा खर्च',isNULL ('','')as 'शासनाने नेमुन दिलेले प्रादेशिक विभागासाठीचे लक्ष',isNULL ('','') as 'प्रादेशिक विभागाने निश्चित केलेले लक्ष',isNULL ('','')as 'अपघात प्रवण ठिकाण पासुन',sum(a.[AccidentExecuted])as 'अपघात प्रवण ठिकाण पर्यंत',isNULL ('','') as 'अपघात कार्यवाही',sum(b.[Itarkhrch]) as 'इतर खर्च',isNULL ('','') as 'दवगुनी ज्ञापने',isNULL ('','') as 'पाहणीक्रमांक',isNULL ('','') as 'पाहणीमुद्ये',isNULL ('','') as 'शेरा',sum (b.[Apr]) as [Apr],sum (b.[May]) as [May],sum (b.[Jun]) as [Jun],sum (b.[Jul]) as [Jul],sum (b.[Aug]) as [Aug],sum (b.[Sep]) as [Sep],sum (b.[Oct]) as [Oct],sum (b.[Nov]) as [Nov],sum (b.[Dec]) as [Dec],sum (b.[Jan]) as [Jan],sum (b.[Feb]) as [Feb],sum (b.[Mar]) as [Mar] from BudgetMasterGAT_D as a join GAT_DProvision as b on a.WorkId=b.WorkId  " + whereCondi + groupBy;
            Complet = query + unionQuery;

            return Complet;
        }

        public string GatFBC(string whereCondi, string groupBy)
        {
            query = "SELECT ROW_NUMBER() OVER(PARTITION BY a.[LekhaShirshName],a.[Arthsankalpiyyear],a.[Upvibhag] ORDER BY a.[LekhaShirshName],a.[Arthsankalpiyyear],a.[upvibhag],a.[Taluka]) as 'अ क्र', a.[WorkId] as 'वर्क आयडी',a.[ArthsankalpiyBab] as 'अर्थसंकल्पीय बाब',a.[Arthsankalpiyyear] as 'अर्थसंकल्पीय वर्ष',a.Type as 'योजनेचे नाव',a.[KamacheName] as 'कामाचे नाव',a.[LekhaShirshName] as 'लेखाशीर्ष नाव',a.[SubType] as 'विभाग',a.[Upvibhag] as 'उपविभाग',a.[Taluka] as 'तालुका',convert(nvarchar(max),a.[ShakhaAbhyantaName])+' '+convert(nvarchar(max),a.[ShakhaAbhiyantMobile]) as 'शाखा अभियंता नाव',convert(nvarchar(max),a.[UpabhyantaName])+' '+convert(nvarchar(max),a.[UpAbhiyantaMobile]) as 'उपअभियंता नाव',a.[AmdaracheName] as 'आमदारांचे नाव',a.[KhasdaracheName] as 'खासदारांचे नाव',convert(nvarchar(max),a.[ThekedaarName])+' '+convert(nvarchar(max),a.[ThekedarMobile]) as 'ठेकेदार नाव',convert(nvarchar(max),a.[PrashaskiyKramank])+' '+convert(nvarchar(max),a.[PrashaskiyAmt])+' '+convert(nvarchar(max),a.[PrashaskiyDate]) as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',convert(nvarchar(max),a.[TrantrikKrmank])+' '+convert(nvarchar(max),a.[TrantrikAmt])+' '+convert(nvarchar(max),a.[TrantrikDate]) as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',a.[Kamachevav] as 'कामाचा वाव',a.[karyarambhadesh] as 'कार्यारंभ आदेश',cast(a.[NividaAmt] as decimal(10,2)) as 'निविदा रक्कम % कमी / जास्त',convert(nvarchar(max),a.[NividaKrmank])+' '+convert(nvarchar(max),a.[NividaDate]) as 'निविदा क्र/दिनांक',a.[kamachiMudat] as 'बांधकाम कालावधी',a.[KamPurnDate] as 'काम पूर्ण तारीख',CAST(CASE WHEN b.[MudatVadhiDate] = ' ' or b.[MudatVadhiDate] = '0' THEN N'होय' ELSE N'नाही' END as nvarchar(max)) as 'मुदतवाढ बाबत',a.[GJobKramank] as 'जॉब क्रमांक',a.[GRoadKramank] as 'रस्ता संवर्ग/ क्रमांक',a.[GRoadPrushthbhag] as 'अस्तीत्वातील रस्त्याचा पृष्ठभाग',a.[GRoll] as 'पीक व रोल',a.[GlengthStarted] as 'लांबी किमी. पासून',a.[GlengthUpto] as 'लांबी किमी. पर्यंत',a.[GlengthTotal] as 'लांबी किमी. एकूण',a.[GNewKhadikaran] as 'नवीन खडीकरण',a.[GBM_Carpet] as 'बी एम व कारपेट सिलकोट सह',a.[G20_MM] as '20 मीमी कारपेटसिलकोट सह',a.[GSurface] as 'सरफेस ड्रेसिंग',a.[GRundikaran] as 'रुंदी करण',a.[GBridge_Morya] as 'पूल/ मो-या',a.[GRepairExpn] as 'दुरुस्तीचा प्रती खर्च',a.[GAnya] as 'अन्य',b.[KamachiKimat] as 'कामाची किंमत',b.[MarchEndingExpn] as 'मार्च अखेर खर्च 2017',b.[Magilkharch] as 'मागील खर्च',b.[Chalukharch] as 'चालू खर्च',b.[VarshbharatilKharch] as 'सन 2017-18 मधील माहे एप्रिल/मे अखेरचा खर्च',b.[AikunKharch] as 'एकुण कामावरील खर्च',b.[Takunone] as 'प्रथम तिमाही तरतूद',b.[Takuntwo] as 'द्वितीय तिमाही तरतूद',b.[Takunthree] as 'तृतीय तिमाही तरतूद',b.[Takunfour] as 'चतुर्थ तिमाही तरतूद',b.[Tartud]as 'अर्थसंकल्पीय तरतूद',b.[AkunAnudan] as 'वितरित तरतूद',b.[Magni] as 'मागणी',b.[VidyutikaranAmt] as 'विद्युतीकरणावरील प्रमा',b.[VidyutikaranExpen] as 'विद्युतीकरणावरील वितरित',b.[Itarkhrch] as 'इतर खर्च',b.[Dviguni] as 'दवगुनी ज्ञापने',a.[PahaniMudye] as 'पाहणीमुद्ये',a.[Pahanikramank] as 'पाहणी क्रमांक',b.[Sadyasthiti] as 'देयकाची सद्यस्थिती',convert(nvarchar(max),a.[Sadyasthiti])+' '+convert(nvarchar(max),a.[Shera]) as 'शेरा',b.[Apr] as 'Apr',b.[May] as 'May',b.[Jun] as 'Jun',b.[Jul] as 'Jul',b.[Aug] as 'Aug',b.[Sep] as 'Sep',b.[Oct] as 'Oct',b.[Nov] as 'Nov',b.[Dec] as 'Dec',b.[Jan] as 'Jan',b.[Feb] as 'Feb',b.[Mar] as 'Mar' from BudgetMasterGAT_FBC as a join GAT_FBCProvision as b on a.WorkId=b.WorkId " + whereCondi;
            unionQuery = " union select isNULL ('','')as'अ क्र', 'Total' as 'वर्क आयडी',isNULL ('','') as 'अर्थसंकल्पीय बाब',isNULL ('Total','') as 'अर्थसंकल्पीय वर्ष',isNULL ('','') as 'योजनेचे नाव',isNULL ('','') as 'कामाचे नाव',isNULL ('','') as 'लेखाशीर्ष नाव',isNULL ('','') as 'विभाग',isNULL (a.[Upvibhag],'') as 'उपविभाग',isNULL ('','0') as 'तालुका',isNULL ('','') as 'शाखा अभियंता नाव',isNULL ('','') as 'उपअभियंता नाव',isNULL ('','') as 'आमदारांचे नाव',isNULL ('','') as 'खासदारांचे नाव',isNULL ('','') as 'ठेकेदार नाव',isNULL ('','') as 'प्रशासकीय मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'तांत्रिक मान्यता क्र/रक्कम/दिनांक',isNULL ('','') as 'कामाचा वाव',isNULL ('','') as 'कार्यारंभ आदेश',sum(cast(a.[NividaAmt] as decimal(10,2))) as 'निविदा रक्कम % कमी / जास्त',isNULL ('','') as 'निविदा क्र/दिनांक',isNULL ('','') as 'बांधकाम कालावधी',isNULL ('','') as 'काम पूर्ण तारीख',isNULL ('','') as 'मुदतवाढ बाबत',isNULL ('','') as 'जॉब क्रमांक',isNULL ('','') as 'रस्ता संवर्ग/ क्रमांक',isNULL ('','') as 'अस्तीत्वातील रस्त्याचा पृष्ठभाग',sum(a.[GRoll]) as 'पीक व रोल',isNULL ('','') as 'लांबी किमी. पासून',isNULL ('','') as 'लांबी किमी. पर्यंत',isNULL ('','') as 'लांबी किमी. एकूण',sum(a.[GNewKhadikaran]) as 'नवीन खडीकरण',sum(a.[GBM_Carpet]) as 'बी एम व कारपेट सिलकोट सह',sum(a.[G20_MM]) as '20 मीमी कारपेटसिलकोट सह',sum(a.[GSurface]) as 'सरफेस ड्रेसिंग',sum(a.[GRundikaran]) as 'रुंदी करण',sum(a.[GBridge_Morya]) as 'पूल/ मो-या',sum(a.[GRepairExpn]) as 'दुरुस्तीचा प्रती खर्च',sum(a.[GAnya]) as 'अन्य',sum(b.[KamachiKimat]) as 'कामाची किंमत',sum(b.[MarchEndingExpn]) as 'मार्च अखेर खर्च 2017',sum(b.[Magilkharch]) as 'मागील खर्च',sum(b.[Chalukharch]) as 'चालू खर्च',sum(b.[VarshbharatilKharch]) as 'सन 2017-18 मधील माहे एप्रिल/मे अखेरचा खर्च',sum(b.[AikunKharch]) as 'एकुण कामावरील खर्च',sum(b.[Takunone]) as 'प्रथम तिमाही तरतूद',sum(b.[Takuntwo]) as 'द्वितीय तिमाही तरतूद',sum(b.[Takunthree]) as 'तृतीय तिमाही तरतूद',sum(b.[Takunfour]) as 'चतुर्थ तिमाही तरतूद',sum(b.[Tartud]) as 'अर्थसंकल्पीय तरतूद',sum(b.[AkunAnudan]) as 'वितरित तरतूद',sum(b.[Magni]) as 'मागणी',sum(b.[VidyutikaranAmt]) as 'विद्युतीकरणावरील प्रमा',sum(b.[VidyutikaranExpen]) as 'विद्युतीकरणावरील वितरित',sum(b.[Itarkhrch]) as 'इतर खर्च',isNULL ('','') as 'दवगुनी ज्ञापने',isNULL ('','') as 'पाहणीमुद्ये',isNULL ('','') as 'पाहणी क्रमांक',sum(b.[Sadyasthiti]) as 'देयकाची सद्यस्थिती',isNULL ('','') as 'शेरा',sum (b.[Apr]) as [Apr],sum (b.[May]) as [May],sum (b.[Jun]) as [Jun],sum (b.[Jul]) as [Jul],sum (b.[Aug]) as [Aug],sum (b.[Sep]) as [Sep],sum (b.[Oct]) as [Oct],sum (b.[Nov]) as [Nov],sum (b.[Dec]) as [Dec],sum (b.[Jan]) as [Jan],sum (b.[Feb]) as [Feb],sum (b.[Mar]) as [Mar] from BudgetMasterGAT_FBC as a join GAT_FBCProvision as b on a.WorkId=b.WorkId " + whereCondi + groupBy;

            Complet = query + unionQuery;

            return Complet;
        }
    }
}